function [AK, BK, CK, DK] = fcn(vr, theta)
%the four polytope controllers
%the first
AK1 = [-4.583104534659966	-0.000003918555251	-0.852657554211052	0.000022241439368	-0.000055324183219	0.226103719572552;
-0.000100953642154	-19.696346960421735	0.002682192617622	42.76033100307146	0.002742424931665	-0.00234558639172;
-5.615572137266393	-0.000134080791461	-7.279629505559142	-0.000970998431323	1.131101195820654	-4950.168370996639;
0.000384254986955	-5.814758286924504	-0.000374561831178	-24.845947957439485	-0.051195828936922	0.223925704896791;
0.118785937184533	-0.019403674829048	-357.8295921492337	-0.013481230189445	-1.152448668105984	-106.62184399893928;
-570.3645070582382	18.622588188207043	2400151.4099022443	-82.94910596096408	101.17152185710047	-1044.2647773862948
];
BK1 = [1.794602310915063	-4.583277387940488;
-0.000463529965159	-0.000099875688251;
-9.444823985275056	-5.617048471454191;
0.000102836373571	0.000383948609174;
-751.9905233504525	0.046278591781029;
5049188.378079328	-83.48741902944272
];    
CK1 = [-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926;
-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926
];
DK1 = [0	0;
0	0
];

%the second
AK2 = [-4.583104534342052	-0.000007094057123	-0.852657553663226	0.000028812341688	-0.000055324189236	0.226103719553204;
-0.000029990893029	-1.860230619363554	-0.000047729214032	5.849698188654824	0.002771756339483	-0.00224664348666;
-5.615572137848923	-0.000095726025738	-7.279629509251647	-0.001050752284994	1.131101195320196	-4950.168370997656;
0.000373721448507	-0.670105603712639	-0.001114981244347	-35.503518558807215	-0.051203719138024	0.223918583953977;
0.118785958443495	-0.004588126377195	-357.8295943596764	-0.044154457059062	-1.152448663634328	-106.62184396014531;
-570.3645069404232	18.65488607391846	2400151.40989733	-83.01595394977049	101.17152190987922	-1044.2647772037194
];
BK2 = [1.794602310775699	-4.583277387622381;
-0.000809014598199	-0.000029931464581;
-9.444823980670236	-5.617048472038471;
0.000133972079183	0.000373130771649;
-751.9905234783787	0.046278612205483;
5049188.378078776	-83.48741891339908
];    
CK2 = [-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926;
-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926
];
DK2 = [0	0;
0	0
];

%the third
AK3 = [-4.583104534865707	-0.000003918555238	-0.852657554258648	0.000022241439371	-0.00005532418335	0.226103719572246;
-0.000100953644835	-19.69634696042173	0.002682192627149	42.760331003071464	0.002742866418338	-0.002344492719365;
-5.615572137475574	-0.000134080791002	-7.279629505864933	-0.000970998431287	1.131101195821887	-4950.168370996637;
0.000384254985337	-5.814758286924529	-0.00037456182926	-24.845947957439485	-0.051195721762606	0.223925970394242;
0.118785937805608	-0.019279351443362	-357.82959215004206	-0.01347436704931	-1.152447285056804	-106.62184057344697;
-570.3645070570955	18.622896168171458	2400151.4099022406	-82.94908895925597	101.1715252927286	-1044.2647688770128
];
BK3 = [1.794602311020913	-4.58327738814624;
-0.00046352994244	-0.000099875690929;
-9.444823985708858	-5.617048471663434;
0.000102836379224	0.000383948607557;
-751.990523354038	0.04627859237721;
5049188.378079317	-83.48741902835498
];    
CK3 = [-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926;
-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926
];
DK3 = [0, 0;
0, 0];

%the forth
AK4 = [-4.583104534482906	-0.00000709405711	-0.852657553695791	0.00002881234169	-0.000055324189388	0.22610371955284;
-0.000029990900414	-1.860230619363555	-0.000047729207081	5.849698188654825	0.002772197826156	-0.002245549814304;
-5.615572137992049	-0.000095726025278	-7.279629509460958	-0.001050752284961	1.131101195321514	-4950.168370997652;
0.000373721447122	-0.67010560371266	-0.001114981242844	-35.50351855880722	-0.051203611963708	0.223918849451429;
0.118785959799918	-0.004463802991513	-357.82959436094615	-0.04414759391891	-1.152447280574985	-106.62184053465921;
-570.3645069362013	18.65519405388234	2400151.4098973274	-83.01593694806434	101.17152532542588	-1044.264768744284
];
BK4 = [1.794602310848205	-4.583277387763241;
-0.000809014576189	-0.000029931471965;
-9.444823980967229	-5.617048472181639;
0.00013397208373	0.000373130770264;
-751.9905234836705	0.046278613536906;
5049188.378078763	-83.48741890926573
];    
CK4 = [-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926;
-0.000000000112934	-0.038864802105173	0.000180429885552	5.275360441202041	0.00864598278463	0.020351516040926
];
DK4 = [0, 0;
0, 0];

%===================================================================================
wind_velocity_min = 13;
wind_velocity_max = 25;
theta_min = 0;
theta_max = 1;
%
denominator = (wind_velocity_max - wind_velocity_min) * (theta_max - theta_min);
%
rou1 = (vr - wind_velocity_min)*(theta - theta_min)/denominator;
rou2 = (vr - wind_velocity_min)*(theta_max - theta)/denominator;
rou3 = (wind_velocity_max - vr)*(theta - theta_min)/denominator;
rou4 = (wind_velocity_max - vr)*(theta_max - theta)/denominator;

%here is the controller
AK = rou1*AK1 + rou2*AK2 + rou3*AK3 + rou4*AK4;
BK = rou1*BK1 + rou2*BK2 + rou3*BK3 + rou4*BK4;
CK = rou1*CK1 + rou2*CK2 + rou3*CK3 + rou4*CK4;
%DK = rou1*DK1 + rou2*DK2 + rou3*DK3 + rou4*DK4;
DK = DK1;