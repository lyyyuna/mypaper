function [AK, BK, CK, DK] = fcn(vr, theta)

%请注意，embedded m-file 注释里面不能有中文
%所以当如此使用时请将中文注释去掉

%the four polytope controllers
%the first
AK1 = [-92.4228, 0, 20.1769, 0, -0.0004;
        0, -53.5268, 0, -0.3863, -2758.602;
        -163.717, 0.0001, -19.185, -0.0006, 0.0028;
        -0.0022, 967.3562, -0.0004, -0.7853, -155.0111;
        5.3787, 12434082.1606, -1.6661, 88.3111, -404252.8848];
BK1 = [77.8024, 0;
        0, 95.9773;
        162.0236, -0.0001;
        0.0023, -1739.0603;
        0.1894, -22340125.5406];    
CK1 = [0.0475, 0, -4.499 -0.0001, -0.0003];
DK1 = [0, 0];

%the second
AK2 = [-35.794, 0, 1.7817, 0, -0.0004;
        0, -43.742, 0, 0.3863, -2758.9201;
        -113.8964, 0.0001, -27.8457, -0.0006, 0.0028;
        -0.0004, 966.9712, -0.0008, -0.7853 -154.9986;
        5.3787, 12424378.434, -1.6654, 88.2454, -403937.4015];
BK2 = [35.8963, 0;
        0, 78.3972;
        118.3728, -0.0001;
        0.0008, -1738.3686;
        0.1854, -22322691.0027];    
CK2 = [0.0475, 0, -4.499, -0.0001, -0.0003];
DK2 = [0, 0];

%the third
AK3 = [-92.3485, 0, 20.179, 0, -0.0004;
        0, -53.2154, 0, 0.3863, -2758.6121;
        -162.2321, 0.0001, -19.1436, -0.0006, 0.0028;
        -0.0022, 967.3904, -0.0004, -0.7853, -155.0122;
        5.3788, 12434323.728, -1.6661, 88.3128, -404260.7386];
BK3 = [77.724, 0;
        0, 95.4178;
        160.4581, -0.0001;
        0.0023, -1739.1218;
        0.1894, -22340559.561];    
CK3 = [0.0475, 0, -4.499, -0.0001, -0.0003];
DK3 = [0, 0];

%the forth
AK4 = [-36.4478, 0, 1.7635, 0, -0.0004;
        0, -43.8122, 0, 0.3863, -2758.9178;
        -116.2555, 0.0001, -27.9115, -0.0006, 0.0028;
        -0.0004, 967.0985, -0.0008, -0.7853, -155.0027;
        5.3775, 12425923.7385, -1.6657, 88.2534, -403987.6417];
BK4 = [36.5856, 0;
        0, 78.5232;
        120.86, -0.0001;
        0.0009, -1738.5973;
        0.1876, -22325467.4273];    
CK4 = [0.0475, 0, -4.499, -0.0001, -0.0003];
DK4 = [0, 0];

%===================================================================================
wind_velocity_min = 18;
wind_velocity_max = 25;
theta_min = 0;
theta_max = 1;
%
denominator = (wind_velocity_max - wind_velocity_min) * (theta_max - theta_min);
%
rou1 = (vr - wind_velocity_min)*(theta - theta_min)/denominator;
rou2 = (vr - wind_velocity_min)*(theta_max - theta)/denominator;
rou3 = (wind_velocity_max - vr)*(theta - theta_min)/denominator;
rou4 = (wind_velocity_max - vr)*(theta_max - theta)/denominator;

%here is the controller
AK = rou1*AK1 + rou2*AK2 + rou3*AK3 + rou4*AK4;
BK = rou1*BK1 + rou2*BK2 + rou3*BK3 + rou4*BK4;
CK = rou1*CK1 + rou2*CK2 + rou3*CK3 + rou4*CK4;
DK = rou1*DK1 + rou2*DK2 + rou3*DK3 + rou4*DK4;



