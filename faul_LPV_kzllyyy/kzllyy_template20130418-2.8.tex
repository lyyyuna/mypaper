% kzllyy_template.tex
% 已经录用的文章按照本刊要求需进行LaTex排版，这是模版内容。
% 最新修改日期：2011-06-24
\input kzllyyhead
% 请仔细阅读文件kzllyyhead.tex, 但是不要更改其中的内容.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%      文章正文
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 标题，基金项目，作者，通信地址定义
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\makeatother
\begin{CJK*}{GBK}{song}
\title{\LARGE\textbf{基于LPV增益调度技术的风机主动容错控制}\\ \vspace{-0.9cm}
\begin{minipage}[c]{10cm}
\vspace{-2.0cm} \hskip -3.4cm \footnotesize{DOI:
10.7641/CTA.201x.xxxxx}
\end{minipage}
\footnotetext{\scriptsize \hskip -6pt
\hspace*{-0.1em}收稿日期: xxxx$-$xx$-$xx; 收修改稿日期: xxxx$-$xx$-$xx.\\
\hspace*{1.1em}$^{\dag}$通信作者. E-mail: lyyyuna@gmail.com; Tel.: +86 .\\
\hspace*{1.1em}基金项目: 国家杰出青年科学基金资助项目();
教育部重点科研基金资助项目().}}
\author{{\large {\CJKfamily{fsong}吴定会\makebox{$^{1}$}\makebox{$^{\dag}$},~~李意扬\makebox{$^{1}$}}}\\
\scriptsize
 (1. 江南大学~物联网工程学院, 江苏~无锡~214000)}
\date{}  % 这一行用来去掉默认的日期显示
\CJKcaption{GB}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 奇数页页眉
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fancyhead[CO]{{\footnotesize 吴定会等: 基于LPV增益调度技术的风机主动容错控制}}            %请在这里写出第一作者以及论文题目
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  请作者不要修改下面4条命令！
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\abovedisplayskip}{1.5mm}
\setlength{\belowdisplayskip}{1.5mm}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  显示title，并设页码为空(按杂志社要求）
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%      中文摘要
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\oddsidemargin}{ 1cm}  % 3.17cm - 1 inch
\setlength{\textwidth}{15.5cm} \vspace{-1.2cm}
\begin{center}
\parbox{\textwidth}{\setlength{\parindent}{1em}

\footnotesize {\CJKfamily{hei} 摘要:}
针对风能转换系统具有非线性和参数的不确定性，提出了基于LPV增益调度
的风能转换系统的主动容错控制方法，解决故障对风力
机组带来的不稳定性问题。基于LPV凸分解方法，将风能转化系统非线性模
型化为具有凸多面体结构LPV模型，利用LMI技术对凸多面体各个顶点分别设计
$ H\infty $控制器，再利用各顶点设计的反馈控制器得到具有凸多面体结构
LPV容错控
制器。仿真结果表明，LPV增益调度技术可以成功地应用于风能转换系统的
容错控制。

{\CJKfamily{hei} 关键词:} 风能转换系统; 主动容错控制; LPV增益调度技术;
凸分解

{\CJKfamily{hei}中图分类号:}  TK81\qquad~~
{\CJKfamily{hei}文献标识码: A }}
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%          英文摘要
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vspace{.1cm}
\begin{center}
\parbox{\textwidth}{\setlength{\parindent}{1em}
{\centering\Large\textbf{Active Fault-Tolerant LPV Control of
Wind Turbines
\\}} \vspace{-1.2mm}
\begin{center}
WU Ding-hui\makebox{$^{1}$}\makebox{$^{\dag}$},~~LI Yi-yang\makebox{$^{1}$ }\\[2pt]
\scriptsize{(1. School of Internet of Things, Jiangnan
University,\\ Wuxi Jiangsu 214112, China)}
\end{center}

\vspace{-10pt}\footnotesize{\textbf{Abstract:}
According to the pitch actuator fault of WECS (Wind Energy Conversion
System) has nonlinear properties and uncertain parameters, an active
fault tolerant control technology of WECS was proposed to resolve the
 dynamic stability problems of the wind turbines, which based on the
LPV gain scheduling technology. The linearized model around the
operating point of wind turbine and fault were converted into convex
polyhedron structure LPV model by using LPV convex decomposition method.
Then each vertex of convex polyhedron was designed to meet the $H\infty$
performance by using LMIs (linear matrix inequalities). All the vertex
gain were synthesized to get LPV controller with convex polyhedron
structure. The simulation result shows that the LPV active fault
tolerant controller could be applied to the WECS successfully.

\textbf{Key words:} WECS; active fault tolerant control;
LPV gain scheduling technology; convex decomposition}}
\end{center}

\renewcommand\refname{\normalsize{{\CJKfamily{hei}参考文献}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  正文由此开始－－－－－－－－－－－－－－－－－－－－－－－－－
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  恢复正文页边距
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setlength{\oddsidemargin}{-.5cm}  % 3.17cm - 1 inch
 \setlength{\textwidth}{171mm}
\CJKfamily{song}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  分栏开始
\begin{multicols}{2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fontsize{10.5bp}{12.9bp}\selectfont
\section{引言({\rm Introduction})}
最近20年，风机的总装机量增长迅速，从1992年的2.5GW到2010年的200GW\!\cite{1}。
随着对风机效率和可靠性要求的提高，现代风机不再如传统风机那样一味追求
高的产能，而是将更多的考虑成本问题，如可靠性，运维成本，风机的使用寿
命等等。由于大多数风机安装在远离人烟的地区，将容错控制技术引入风力发
电系统可以大幅减少维护的成本。容错控制是在保证当控制系统中的某些部件
发生故障时，还能安全地完成控制任务的一种控制技术。容错控制包括被动容
错和主动容错，其中被动容错控制\!\cite{2}是考虑正常工作和故障状态的参数值设计
适当固定结构的控制器，在故障前后使用同样的控制器。主动容错\!\cite{2}则是在
故障发生后重新调整控制器参数，或者改变控制器结构，与被动容错最大的不
同在于依赖故障诊断机构。

从控制的角度看，风速的变化和故障的发生导致了风力机的的动态特性在工作
点附近发生非线性变化，又由于缺少风力机精确的数学模型，传统的控制器设
计策略难以着手\cite{3,4}。无论是传统的鲁棒技术\cite{3}还是一般的增益调度
控制\cite{4}，对对象参数的变化和工作点的选取，要求都非常苛刻，不符合实
际情况。基于鲁棒控制的线性参数变化(Linear Parameter Varying, LPV)
增益调度技术对这种动态特性变化显著的风力系统会非常有效\cite{5,6}。对
海上风力系统来讲，鲁棒性和容错性都是必不可少的主要特性，而LPV控制
方法恰恰能够同时处理由风速、故障带来的参数变化和模型本身描述不
精确的问题。

LPV容错控制器采用当前工作点附近的风速估计值和故障诊断机构输出的故
障信息作为增益调度变量，将模型转换为仿射依赖型，在线性矩阵不等
式(Linear Matrix Inequalities LMIs)约束下求出最优控制器。

在一个实际的系统中，传感器，执行器和系统构件中均可能发生故障，从缓
慢变化的到急性的。这些故障所表现出的共性就是系统动态特性的变化，从
而使它们大部分都可被描述成一个线性变化的的参数。本文中，为了突出控
制器的设计过程，选取了一种常见的单一故障，即桨距执行器的液压系统故
障。当液油中混入过多空气，桨距执行器的动态特性就会变差，从而影响在
额定风速之上时，风机的恒功率控制[7]。在实际运行和仿真中，虽然LPV的
综合过程中LMI迭代求解计算量大，但LPV容错控制器是离线计算，在线运行
时只需在每个采样周期，根据故障信息的变化，经过简单的算数运算，便可
得出随增益调度变量变化的控制器，涉及的运算量很小。还有一个问题，在
实际系统中，在有限的采样周期内获得故障信息的精确估计是不太可能的，值
的庆幸的是Apkarian等人[8]已经证实LPV对时变参数的估计误差并不敏感，不
需精确估计就可将LPV控制应用于系统的容错控制。

本文组织如下：第2章描述了风力机和故障数学模型，并推导出了其对应的
LPV仿射依赖模型。在第3章将无限维的控制器转换为顶点的凸优化问题，并
给出了计算的步骤。第4章和第5章中，给出无容错和有容错控制器的对比
仿真图，并对仿真结果进行分析，最后给出了结论。

\section{风力机模型({\rm Wind Turbine Model})}
在仿真中，使用了风力机的非线性模型，其中包括空气动力学子模型，传
动机构子模型，桨距执行器子模型和故障模型[9]。
\subsection{空气动力学模型({\rm Aerodynamic Model})}
风力机的叶桨将风能转换到转子侧，以速度$\omega_r(t)$旋转。风的动能依赖
于风速$v_r(t)$，空气密度$\rho$和叶桨的等效面积$A$。风能转换到转子侧的能
量的效率为$C_p(\lambda(t),\beta(t))$，这是桨距角$\beta(t)$和叶尖
速比$\lambda(t)$的函数。气动转矩可由下式给出：
\begin{eqnarray}\label{e:1}
T_a(t)=\frac{1}{2\omega_r(t)}\rho{}Av^3_r(t)C_p(\lambda(t),\beta(t))
\end{eqnarray}

\subsection{传动机构模型({\rm Drive Train Model})}
传动机构是低速侧和高速侧组成。低速和高速侧转动惯
量分别为$J_r$和$J_g$，摩擦系数分别为$B_r$和$B_g$，高低两侧的齿轮
比为$N_g$。为更好的模拟真实传动机构，考虑粘性摩擦，扭
力衰减系数是$B_{dt}$，扭转刚度是$K_{dt}$。传动系统的输出是扭矩
角$\theta_\delta(t)$，电机产生的转矩$T_g(t)$和发电机转
速$\omega_g(t)$。模型如下：
\begin{eqnarray}\label{e:2}
J_r\dot{\omega}_r(t) &=& T_a(t) + \frac{B_{dt}}{N_g}\omega_g(t)\notag -K_{dt}\theta_\Delta(t)  \\
&& -(B_{dt}+B_r)\omega_r(t) \\
\label{e:3}
J_g\dot{\omega}_g(t) &=& \frac{K_{dt}}{N_g}\theta_\Delta(t) +\frac{B_{dt}}{N_g}\omega_r(t)\notag -T_g(t) \\
&& -(\frac{B_{dt}}{N^2_g}+B_g)\omega_g(t) \\
\label{e:4}
\dot{\theta}_\Delta(t) &=& \omega_r(t)-\frac{1}{N_g}\omega_g(t)
\end{eqnarray}

\subsection{包含故障信息的桨距执行器模型({\rm Pitch System Model Including Fault Model})}
桨距执行器模型如下:
\begin{eqnarray}\label{e:5}
\ddot{\beta}(t)&=&-2\xi\omega_n\dot{\beta}(t)-\omega^2_n\beta(t)
 +\omega^2_n\beta_{ref}(t-t_d)
\end{eqnarray}
其中$t_d$是变桨距执行器的时间常数，$\beta_{ref}(t)$是桨距角
的参考值，$\omega_n$是变桨距执行器模型的自然振荡
频率。$xi$是变桨距执行器模型的阻尼系数。

桨距执行器中液压油空气含量过高的故障，其
变化主要影响的是阻尼系数$\xi$、自然振荡频
率$\omega_n$。$\alpha_{ha}$为故障影响因子。其故障模型为:
\begin{eqnarray}\label{e:6}
\bar{\xi}(t) &=& (1-\alpha_{ha}(t))\xi_{min} + \alpha_{ha}(t)\xi_{max} \\
\label{e:7}
\bar{\omega}_n(t) &=& (1-\alpha_{ha}(t))\omega_{n,min} + \alpha_{ha}(t)\omega_{n,max}
\end{eqnarray}
当故障影响因子$\alpha_{ha}=0$变成$\alpha_{ha}=1$，其对应的空气密度就从$7\%$变化为$15\%$。

\subsection{风力机LPV模型 ({\rm LPV Model of Wind Turbine})}
空气动力学模型中的$C_p(\lambda(t),\beta(t))$是风力机呈现非线性的动态特
性的主因。使用一阶泰勒公式对气动转矩展开，得：
\begin{eqnarray}\label{e:8}
T_a \approx \bar{T}_a(\bar{v}_r,\bar{\omega}_r,\bar{\beta}) +
\frac{\partial{}T_a}{\partial{}\beta}\hat{\beta} +
\frac{\partial{}T_a}{\partial{}v_r}\hat{v}_r +
\frac{\partial{}T_a}{\partial{}\omega_r}\hat{\omega}_r
\end{eqnarray}
其中
\begin{eqnarray}
&&\left\{\begin{aligned}
& \frac{\partial{}T_a}{\partial{}v_r} = \frac{\rho{}Av^2_r}{2\omega_r}
(3C_p+v_r\frac{\partial{}C_p}{\partial\lambda}\frac{\partial\lambda}{\partial{}v_r}) \notag\\
& \frac{\partial{}T_a}{\partial\omega_r} = \frac{\rho{}Av^3_r}{2\omega_r}
(\frac{\partial{}C_p}{\partial\lambda}\frac{\partial\lambda}{\partial\omega_r} - \frac{C_p}{\omega_r})  \notag\\
& \frac{\partial{}T_a}{\partial\beta} = \frac{\rho{}Av^3_r}{2\omega_r}
\frac{\partial{}C_p}{\partial\beta}
\end{aligned}
\right.
\end{eqnarray}

展开后的泰勒表达式的分量均为近似为
风速$v_r$的线性函数，这意味着可将风速作
为LPV模型的增益调度变量：
\begin{eqnarray}
\theta_{op}(t):=v_r(t)
\end{eqnarray}

同时将故障影响因子作为另一个增益调度变量：
\begin{eqnarray}
\theta_f(t):=\alpha_{ha}
\end{eqnarray}

选取系统状态变量，控制量分别为：
$x(t)=[\beta(t),\dot{\beta}(t),\theta_\Delta(t),\omega_g(t),\omega_r(t)]^\mathrm{ T }$，
$u(t)=\beta_{ref}(t)$。
便可得出变桨距风力机系统的LPV模型：
\begin{eqnarray}\label{e:plant}
\dot{x}(t) &=& A(\theta_{op},\theta_f)x(t) + B_1(\theta_{op},\theta_f)w(t)\notag \\
&&+ B_2(\theta_{op},\theta_f)u(t)
\end{eqnarray}
其中
\begin{eqnarray}
A(\theta_{op},\theta_f) &=&
\left[
\begin{smallmatrix}
0 & \omega^2_n(t) & 0  \\
-1 & -2\xi\omega^2_n(t) & 0  \\
0 & 0 & 0 \\
0 & 0 & \frac{K_{dt}}{J_g{}N_g}  \\
\frac{1}{J_r}\frac{\partial{}T_a(\theta_{op}(t))}{\partial\beta} & 0 &
-\frac{K_{dt}}{J_r}
\end{smallmatrix}
\right. \notag\\
&&\left.
\begin{smallmatrix}
 0 & 0 \\
 & 0 & 0 \\
 -\frac{1}{N_g} & 1 \\
-(\frac{B_{dt}}{J_g{}N^2_g} + \frac{B_g}{J_g}) & \frac{B_{dt}}{N_g{}J_g} \\
 \frac{B_{dt}}{N_g{}J_r} &
-\frac{B_{dt}+B_r}{J_r} + \frac{1}{J_r}\frac{\partial{}T_a(\theta_{op}(t))}{\partial\omega_r}
\end{smallmatrix}
\right]
\notag\\%% second
B_1(\theta_{op},\theta_f)&=&[0,0,0,0,\frac{1}{J_r}
\frac{\partial{}T_a(\theta_{op}(t))}{\partial{}v_r}]^\mathrm{ T }
\notag\\%% third
B_2(\theta_{op},\theta_f)&=&[0, 1, 0, 0, 0]^\mathrm{ T }
\notag
\end{eqnarray}

系统可以改写成仿射依赖型：
\begin{eqnarray}
A(\theta_f,\theta_{op})\triangleq A + A^{\theta_{op}}(\theta_{op})
+A^{\theta_f}(\theta_f)
\end{eqnarray}

$A^{\theta_{op}}$是$A(\theta_f,\theta_{op})$中依赖于
变参数$\theta_{op}$的部分，$A^{\theta_f}$是$A(\theta_f,\theta_{op})$中
依赖于变参数$theta_f$的部分。$\theta_{op}$和$\theta_f$组成多面
体$\Lambda$，其中$\theta_{f,min}<\theta_f<\theta_{f,max}$，$\theta_{op,min}<\theta_{op}<\theta_{op,max}$。
$(\theta_f,\theta_{op})$所构成的顶点在多
面体$\Lambda$内取值。

\section{主动容错控制器设计({\rm AFTC Design Method})}
容错控制器是在LPV技术框架下对传统的PI调节器的重新
设计，如图\ref{fig:1}所示，选取发电机转速及其积分值作为观测器
输出$y=[\omega_g,y_\omega]^\mathrm{ T }$，控制器输出桨距参考值$\beta_{ref}$控制风力机。本小节将设计
一个与对象(\ref{e:plant})具有系统参数依赖关系的LPV控制器$K(\theta),\theta=(\theta_f,\theta_{op})$，即：
\begin{eqnarray}\label{e:controller}
&&\left\{\begin{aligned}
\dot{x}_K(t) = A_K(\theta)x_K(t) + B_K(\theta)y(t) \\
u(t) = C_K(\theta)x_K(t) + D_K(\theta)y(t)
\end{aligned}
\right.
\end{eqnarray}
\begin{center}
\includegraphics [scale=1,trim=0 0 0 0]{structure.eps}\\
\label{fig:1}
{\fontsize{9.3pt}{11.6pt}\selectfont 图~\ref{fig:1}~~图形标题\\
Fig.~\ref{fig:1}~~Title of figure }
\end{center}
对象(\ref{e:plant})与控制器(\ref{e:controller})所构成系统的状态空间表示为：
\begin{eqnarray}\label{e:plant_cont}
&&\left\{\begin{aligned}
\dot{x}(t) &=& A(\theta)x(t) + B_1(\theta)w(t) + B_2(\theta)u(t) \\
z(t) &=& C_1(\theta)x(t) + D_{11}(\theta)w(t) + D_{12}(\theta)u(t) \\
y(t) &=& C_2(\theta)x(t) + D_{21}(\theta)w(t) + D_{22}(\theta)u(t)
\end{aligned}
\right.\notag\\
\end{eqnarray}
其对应的闭环系统为：
\begin{eqnarray}\label{e:closedloop}
&&\left\{\begin{aligned}
\dot{x}_{cl} = A_{cl}(\theta)x_{cl} + B_{cl}(\theta)y \\
z = C_{cl}(\theta)x_{cl} + D_{cl}(\theta)y
\end{aligned}
\right.
\end{eqnarray}
式中，
\begin{eqnarray}
  A_{cl}(\theta) &=& A_0(\theta) + \mathcal{BF}(\theta)\mathcal{C} \notag\\
  B_{cl}(\theta) &=& B_0(\theta) + \mathcal{BF}(\theta)\mathcal{D}_{21} \notag\\
  C_{cl}(\theta) &=& C_0 + \mathcal{D}_{12}\mathcal{F}(\theta)\mathcal{C} \notag\\
  D_{cl}(\theta) &=& D_{11} + \mathcal{D}_{12}\mathcal{F}(\theta)\mathcal{D}_{21} \notag
\end{eqnarray}
且\\
\begin{eqnarray}
  A_0(\theta) &=&
  \begin{bmatrix}
    A(\theta) & ~~0 \\
    0 & ~~0
  \end{bmatrix},
  B_0(\theta) =
  \begin{bmatrix}
    B_1(\theta) \\
    0
  \end{bmatrix}, \notag \\
  C_0(\theta) &=& \begin{bmatrix}
    C_1 & ~~0
  \end{bmatrix} ,
  \mathcal{B} = \begin{bmatrix}
    0 & ~~B_2 \\
    I & ~~0
  \end{bmatrix}, \notag
  \\
  \mathcal{C} &=& \begin{bmatrix}
  0 &~~ I\\
  C_2 &~~ 0
  \end{bmatrix},
  \mathcal{D}_{12} = \begin{bmatrix}
    0 &~~ D_{12}
  \end{bmatrix},
  \mathcal{D}_{21} = \begin{bmatrix}
    0 \\
    D_{21}
  \end{bmatrix} \notag
\end{eqnarray}





\subsection{容错控制问题的提出 ({\rm Proposal of Fault-Tolerant Control Problem})}
\textbf{问题1} 容错控制器的设计问题可以描述为：寻找一
个LPV控制器$K(\theta),\theta=(\theta_f,\theta_{op})$，使
得当$(\theta_f,\theta_{op})$在多面体$\Lambda$内变化时，闭环
系统(\ref{e:closedloop})二次稳定，且$w$到$z$的闭环传递函数的$L_2$诱
导范数小于$\gamma$。

\begin{Site}\label{site:projection}(投影引理)
给定一个对称阵$\Psi\in{}R^{m\times{}n}$，两个具有$m$列的矩
阵$P$和$Q$，寻找具有适当维数的矩阵$\Omega$，使得：
\begin{eqnarray}\label{e:projection}
\Psi + P^\mathrm{ T }X^\mathrm{ T }Q + Q^\mathrm{ T }X{}P<0
\end{eqnarray}
令$W_P$，$W_Q$分别为矩阵$P$和$Q$的零空
间，则不等式(\ref{e:projection})有解$X$的充分必要条件为：
\begin{eqnarray}
&&\left\{\begin{aligned}
W^\mathrm{T}_P \Psi W_P < 0 \\
W^\mathrm{T}_Q \Psi W_Q < 0
\end{aligned}
\right.
\end{eqnarray}
\end{Site}

\begin{Site}\label{site:realbound}(有界实引理)下列命题等价：\\
(1)~~对于所有可能的参数轨迹$\theta\in\Delta$，LPV闭环
系统(\ref{e:closedloop})二次稳定且$w$到$z$的闭环传递函数
的$L_2$诱导范数小于$\gamma$。\\
(2)~~线性矩阵不等式(\ref{e:realbound})存在正定对
称解$x_{cl}>0$，且$i=1,2,..r$，$r$为顶点个数，使：
\begin{eqnarray}
\begin{bmatrix}\label{e:realbound}
A^\mathrm{T}_{cl}(\theta_i)x_{cl}+x_{cl}A_{cl}(\theta_i) &
x_{cl}B_{cl}(\theta_i) & C^\mathrm{T}_{cl}(\theta_i) \\
B^\mathrm{T}_{cl}(\theta_i)x_{cl} & -\gamma{}I & D^\mathrm{T}_{cl}(\theta_i) \\
C_{cl}(\theta_i) & D_{cl}(\theta_i) & -\gamma{}I
\end{bmatrix}
<0 \notag
\\
\end{eqnarray}
\end{Site}

\subsection{LPV控制器求解 ({\rm Computation of LPV Controller})}
由于上述的参数轨迹$\theta\in\Lambda$是定义在连续的空间，如果对
每一个点求解控制器，会涉及到无限多个LMIs，这是
不可能求解的。本小节中，将无限维的问题转化为顶
点的凸优化问题，通过求解有限个顶点的LMIs，得出
满足$\gamma$的容错控制器。
\begin{Thm}
设$N_R$和$N_S$分别为$[B^\mathrm{T}_2, D^\mathrm{T}_{12}]$和$[C_2, D_{21}]$\newline
核空间的基，$i=1,2,..,r$，$r$为顶点个数，则问题1有解的充要条
件为存在矩阵$R,S\in{}R^{n\times{}n}$，满足
下列线性矩阵不等式：
\begin{eqnarray}
% first LMI
\label{e:19}
\begin{bmatrix}
N_R & 0 \\
0 & I
\end{bmatrix}^\mathrm{T}
\begin{bmatrix}
A_i{}R + RA^\mathrm{T}_i & RC^\mathrm{T}_{1i} & B_{1i} \\
C_{1i}R & -\gamma{}I & D_{11i} \\
B^\mathrm{T}_{1i} & D^\mathrm{T}_{11i} & -\gamma{}I
\end{bmatrix}
\begin{bmatrix}
  N_R & 0 \\
  0 & I
\end{bmatrix}
<0 \notag\\
\\
% the second LMI
\label{e:20}
\begin{bmatrix}
  N_S & 0 \\
  0 & I
\end{bmatrix}^\mathrm{T}
\begin{bmatrix}
  A_i{}S+SA^\mathrm{T}_i    &  SC^\mathrm{T}_{1i}  &  B_{1i}  \\
  C_{1i}S   &  -\gamma{}I   & D_{11i}  \\
  B^\mathrm{T}_{1i}   &   D^\mathrm{T}_{11i}  &   -\gamma{}I
\end{bmatrix}
\begin{bmatrix}
  N_S  &   0  \\
  0    &   I
\end{bmatrix}
<0 \notag \\
\end{eqnarray}
\begin{eqnarray}
% the third LMI
\label{e:21}
\begin{bmatrix}
  R &~~& I \\
  I &~~& S
\end{bmatrix}
\geq 0
\end{eqnarray}
\end{Thm}
\textbf{证}~~~~
根据引理\ref{site:realbound}，问题1存在一个$k$阶LPV容错
控制器的充分必要条件是线性矩阵不等式(\ref{e:realbound})存
在正定对称解$0<x_{cl}\in{}R^{(n+k)\times(n+k)}$，且
式(\ref{e:realbound})可以改写为：
\begin{eqnarray}\label{e:22}
  \Psi_i + P^\mathrm{T}_x{}F_i{}Q + Q^\mathrm{T}F^\mathrm{T}_i{}P_x <0
\end{eqnarray}
式中
\begin{eqnarray}
  \Psi_i &=&
  \begin{bmatrix}
    A^\mathrm{T}_0(\theta_i)x_{cl}+x_{cl}A_0(\theta_i) ~~& x_{cl}B_0(\theta_i) & C^\mathrm{T}_0 \\
    B^\mathrm{T}_0(\theta_i)x_{cl} & -\gamma{}I & D^\mathrm{T}_{11} \\
    C_0 & D_{11} & -\gamma{}I
  \end{bmatrix} \notag \\
  P_x &=& \begin{bmatrix}
  B^\mathrm{T}x_{cl} ~~&~~ 0 ~~&~~ D^\mathrm{T}_{12}
  \end{bmatrix},
  Q = \begin{bmatrix}C ~~&~~ D_{21} ~~&~~ 0\end{bmatrix} \notag
\end{eqnarray}


由引理\ref{site:projection}可知，线性矩阵不等
式(\ref{e:22})成立的充分必要条件是：
 \begin{eqnarray} \label{e:23}
   W^\mathrm{T}_{Px}\Psi_i{}W_{Px}<0,
   W^\mathrm{T}_{Q}\Psi_i{}W_{Q}<0
 \end{eqnarray}
其中$W_{Px},W_Q$分别为$P_x,Q$零空间的任意基。

由于
\begin{eqnarray}
  P_x &=& \begin{bmatrix}
    \mathcal{B}^\mathcal{T} & ~~~0 ~~~& \mathcal{D}_{12}^\mathcal{T}
  \end{bmatrix}
  \begin{bmatrix}
    x_{cl} & ~~~0~~~ & 0 \\
    0 & I & 0\\
    0 & 0 & I
  \end{bmatrix}
\end{eqnarray}

令向量$P=\begin{bmatrix}
    \mathcal{B}^\mathcal{T} & ~~~0~~~ & \mathcal{D}_{12}^\mathcal{T}
  \end{bmatrix}$，
则$P$对应的零空间的任意基与$W_P$的关系为：
\begin{eqnarray}
  W_{Px} =
  \begin{bmatrix}
    x^{-1}_{cl} & ~~~0~~~ & 0 \\
    0 & I & 0 \\
    0 & 0 & I
  \end{bmatrix}
  W_P
\end{eqnarray}

那么式(\ref{e:23})的第一个不等式可改写为：
\begin{eqnarray}
  W^\mathrm{T}_P \phi_i W_P < 0
\end{eqnarray}
其中\\
\begin{eqnarray}
  \phi_i =
  \begin{bmatrix}
    A^\mathrm{T}_0(\theta_i)x^{-1}_{cl}+x^{-1}_{cl}A_0(\theta_i) ~~& B_0(\theta_i) & x^{-1}_{cl}C^\mathrm{T}_0 \\
    B^\mathrm{T}_0(\theta_i) & -\gamma{}I & D^\mathrm{T}_{11} \\
    C_0x^{-1}_{cl} & D_{11} & -\gamma{}I
  \end{bmatrix} \notag
\end{eqnarray}

令$N_R=\begin{bmatrix}
  P_1 \\
  P_2
\end{bmatrix},
N_S=\begin{bmatrix}
  Q_1 \\
  Q_2
\end{bmatrix}$分别为$[
  B^\mathrm{T}_2, D^\mathrm{T}_{12}]$和$[
  C_2, D_{21}]$的零空间的任意基，则$P$和$Q$的零空间的基分别为：
\begin{eqnarray}
  W_P=\begin{bmatrix}
    P_1 &~~ 0 \\
    0 &~~ 0 \\
    0 &~~ I \\
    P_2 &~~ 0
  \end{bmatrix},
  W_Q=\begin{bmatrix}
    Q_1 &~~ 0 \\
    0 &~~ 0 \\
    Q_2 &~~ 0 \\
    0 &~~ I
  \end{bmatrix}
\end{eqnarray}

因此，式(\ref{e:23})可以进一步转换为式(\ref{e:19})和式(\ref{e:20})所
示的形式。

条件$x_{cl}>0$等价于$\begin{bmatrix}
  R &~~& I \\
  I &~~& S
\end{bmatrix}
\geq 0$。 \\
证毕。

由上述定理，便可得LPV容错控制器的求解算法。

\textbf{算法1}\\
第一步~~计算满秩矩阵$M,N\in{}R^{n\times{}k}$，使得：
\begin{eqnarray}
  MN^\mathrm{T} = I - RS
\end{eqnarray}
第二步~~计算方程的唯一解$x_{cl}$：
\begin{eqnarray}
  \begin{bmatrix}
    S &~~& I \\
    N^\mathrm{T} && 0
  \end{bmatrix}
  =x_{cl}
  \begin{bmatrix}
    I &~~& R \\
    0 && M^\mathrm{T}
  \end{bmatrix}
\end{eqnarray}
第三步~~求解不等式(\ref{e:realbound})得：
\begin{eqnarray}
  \begin{bmatrix}
    A_K(\theta) &~& B_K(\theta) \\
    C_K(\theta) && D_K(\theta)
  \end{bmatrix} \notag
  \in
\end{eqnarray}
\begin{eqnarray}
  Co\left\{K_i=\begin{bmatrix}
    A_{Ki} &~~& B_{Ki} \\
    C_{Ki} && D_{Ki}
  \end{bmatrix},
  i=1,2,..,r\right\}
\end{eqnarray}

最后，LPV容错控制器的形式为
\begin{eqnarray}
K=\sum_{i=1}^r\alpha_i{}K_i,\sum_{i=1}^r\alpha_i=1
\end{eqnarray}



\section{仿真结果 (\rm Simulation Result)}
风力机仿真参数见表\ref{tab:1}。
\begin{center}
{\CJKfamily{kai} 表~\ref{tab:1}~~仿真参数\\
Table~\ref{tab:1}~~Parameter value}\\
\label{tab:1} \vskip 3pt
\newcommand{\rb}[1]{\raisebox{1.9ex}[-2pt]{#1}}
%\renewcommand\tabcolsep{2pt}
{\fontsize{9.3pt}{11.6pt}\selectfont
\begin{tabular}{c|c|c|c}
    \hline
    参数        &     值        &  参数     & 值 \\ \hline
    $K_{dt}$    & $2.7GNm/rad$  & $B_r$     & $27.8Nm/(rad/s)$ \\ \hline
    $A$         & $10387m^2$    & $B_{dt}$  & $945kNm/(rad/s)$ \\ \hline
    $\rho$      & $1.225kg/m^3$ & $B_g$     & $3.034Nm/(rad/s)$ \\ \hline
    $\theta_{f,min}$& 0           & $\theta_{f,max}$ & $1$ \\ \hline
    $J_r$       & $55\times10^6kgm^2$ & $\theta_{op,min}$ & $18m/s$ \\ \hline
    $J_g$       & $390kgm^2$    & $\theta_{op,max}$ & $25m/s$ \\ \hline
    $N_g$       & $95$ && \\ \hline
  \end{tabular}
}
\end{center}

在设计中为了体现系统的性能要求，可以
对输出向量进行加权。$W_w$主要是对电机转速反馈进行整形，减弱
风速抖动对稳定性的影响，$W_u$是对桨距参考值取高频分量，强化
控制的作用。加权函数选取如下：
\begin{eqnarray}
  W_w &=& \frac{s^2+2\xi_\Omega\omega_\Omega{}s + \omega^2_\Omega}
  {(s+z_I)(s+\xi_\Omega\omega_\Omega)} \\
  W_u &=& \frac{s+z_3}{s+p_3}
\end{eqnarray}
其中，$\omega_\Omega=0.6283rad/s,\xi_\Omega=0.7,
p_3=1.3425,\\z_3=13.425$。



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  参考文献
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\vskip 12pt
 {\fontsize{7.8pt}{9.4pt}\selectfont
\begin{thebibliography}{99} \vskip 7pt
\setlength{\parskip}{-2pt}  %段落之间的竖直距离
%1
\bibitem{1}ARIMOTO S, KAWAMURA S, MIYAZAKI F. Bettering operation of
 robotics by learning[J]. \textit{Journal of Robotic System}, 1984, 12(2): 123 -- 140.
%2
\bibitem{2}
YAO Zhongshu, WANG Hongfei, YANG Chengwu. A sort of iterative
learning control algorithm for tracking of robot trajectory[J].
\textit{ACTA Armamentar}II, 2004, 25(3): 330 -- 334.\\
(姚仲舒, 王宏飞, 杨成梧. 一种机器人轨迹跟踪的迭代学习控制方法[J].
兵工学报, 2004, 25(3): 330 -- 334.)
%3
\bibitem{3}DOGRUEL M, OZGUNZER U. Stability of hybrid systems[C] //\textit{Proceedings of IEEE International Symposium on Intelligent
Control}. New York: IEEE, 1994, 8: 129 -- 134.
%4
\bibitem{4}LI B. \textit{The main algorithm research on financial time
series data mining}[D]. Hefei: University of Science and Technology
of China, 2001.
%6
\bibitem{5}WANG R X. \textit{Random Process}[M]. Xi'an : Xi'an Jiaotong University
Press, 1993.
%7
\bibitem{6}HAYKIN S, BROCKETT R W. Adaptive filtering theory[M] //\textit{Essays in Control}. New York, American: Prentice Hall, 1996.
\end{thebibliography}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 附录
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 \vskip 7pt
\normalsize\textbf{ 附录~~~~附录标题}(Appendix~~Title of appendix)\\
\indent
 {\fontsize{9.3pt}{11.6pt}\selectfont{
 附录内容.}}
 \vskip 7pt
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 作者简历
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\noindent
{\CJKfamily{kai} 作者简介:}\\
 {\scriptsize
\indent
\textbf{张~~~~三}~~~~(1961---), 男, 作者简历, 目前研究方向, E-mail: zhangsan@sina.com.cn;\\
\indent \textbf{李某某}~~~~(1958---), 女, 作者简历, 目前研究方向,
E-mail: limm@sina.com.cn.}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  分栏结束
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{multicols}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  文章结束
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\end{CJK*}

\end{document}
